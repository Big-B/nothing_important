+++
title = "Domain am become Cloudflared"
date = 2025-11-29

[taxonomies]
tags = ["blog", "networking"]
+++

Domain is officially transferred over to cloudflare. Need to work on getting the
bastard to actually show up when you go to [mittman.dev](mittman.dev).

Arch repo calls out `ddclient` specifically, so we'll go with that for now. Grab
my api key for DNS settings from cloudflare directly, put that into the
`ddclient` config and we should be good to go?

```bash
# ddclient -daemon=0 -noquiet -debug
```

And... nothing? Literally no output. Running `ddclient --help` gives some useful
examples, specifically it looks like maybe I got zone wrong? It should be
`dns.zone`. Rerunning the debug command and we get nothing again. Found a
[reddit post](https://www.reddit.com/r/SelfHosting/comments/16wnu3s/ddclient_and_cloudflare_dynamic_dns/)
that goes through the config. Looks like my API key needed to be modified to
apply to my whole account, and I messed up the zone (should've left it).

Kicking off the service gives a lot more info. Looks like it's unable to find
the IP address. A few more [web searches](kagi.com) and there was _another_ step
needed. I had to enable a web search to figure out my IP address. It looks like
`ddclient` supports querying certain devices directly, but my goofy-ass setup
isn't supported. Oh well.

Restarted the service and it looks like we're also getting API errors from
cloudflare? Not particularly descriptive, just a 400. Cloudflare says my API key
was last used 3 days ago, so there's still something not quite right here.

Okay, had to make some changes to my cloudflare key as described
[here](https://www.reddit.com/r/SelfHosting/comments/16wnu3s/comment/kk2bo3n/).
Next issue is getting this thing to update both ipv4 and ipv6. Looking at [this
issue](https://github.com/ddclient/ddclient/issues/75) on github, it looks like
we can just run 2 instances of `ddclient` to accomplish this. Gonna follow the
instructions there.

A few moments and reboots later, and it looks like we're in business. Should
have up-to-date A and AAAA records now. Let's fire up nginx and do some port
forwarding on the router and see if we can see the blog.

We can't. Fuuuuuck. Set cloudfare to developer mode so it doesn't cache. Port
forwarding... is "virtual servers" on the tp-link, hopefully?

Looks like maybe I have a DNS issue still. The cloudflare dashboard shows the
proper public IP, but `nslookup` reports bad address for some reason. I wonder
if cloudflare is swapping it out to do its own magic?

It was a DNS thing. Turned off the proxy, and the problem was solved. However,
I'm getting issues with SSL. I can't seem to force a non-ssl connection.
Cloudflare offers a cert solution, so I'll give that a shot. And finally, that
did the trick. Had to re-enable the proxy service, but we are active!

Next up, I'll upload this junk into the site. Some TODOs:
- [ ] Figure out how to get SSH working using mittman.dev
- [ ] Make this website wayyyy less shitty looking
